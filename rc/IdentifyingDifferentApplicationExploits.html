<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8"><title>
	Print content
</title><link href="IdentifyingDifferentApplicationExploits_files/print-styles.css" rel="stylesheet">
    <script src="IdentifyingDifferentApplicationExploits_files/jquery.min.js"></script>
    <script src="IdentifyingDifferentApplicationExploits_files/jspdf.js"></script>
    <script src="IdentifyingDifferentApplicationExploits_files/from_html.js"></script>
    <script src="IdentifyingDifferentApplicationExploits_files/addimage.js"></script>
    <script src="IdentifyingDifferentApplicationExploits_files/filesaver.js"></script>
    <script src="IdentifyingDifferentApplicationExploits_files/pl.js"></script>
</head>
<body>
    <form method="post" action="./vn-print-content.aspx" id="form1">
<div class="aspNetHidden">
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="TMmqv/JeDju0ssxDbwq8ym4MYxtOZc3+3RYlCly9K7KPfxHcGk7znynMQslDDLP8GaJT0ikmI/tiUJlKMzCMnQCwIiQHxUHz8SjhDQMbD5c=">
</div>

<div class="aspNetHidden">

	<input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="918AB9A0">
</div>
    <div>
        

        
        
        <div id="panPrintAvailable">
	
            <div class="print-content-wrapper" id="print-content">
                <!--<button class="save-pdf">PDF</button>-->
                <h1>CompTIA Security+</h1>
                <h2>Identifying Different Application Exploits</h2>
                <div class="print-content-index">
                    <ul>
                        <li>Introduction</li><li>Lab Topology</li><li>Exercise 1 - Cross Site Scripting</li><li>Exercise 2 - SQL Injection</li><li>Exercise 3 - Information Leakage and Improper Error Handling</li><li>Exercise 4 - Race Conditions, Memory Leak, Resource Exhaustion and Overflow Attacks</li><li>Exercise 5 - Directory Traversal and Path Manipulation</li><li>Exercise 6 - Privilege Escalation</li><li>Exercise 7 - Driver Manipulation and Replay Attacks</li><li>Exercise 8 - Pass the Hash, API Attacks, Request Forgeries, Pointer Dereference and SSL Stripping</li><li>Review</li>
                    </ul>
                </div>
                <div class="print-content-content">
                    <h2 class="exercise-title" id="cn-m18-0"><b>Introduction</b></h2>

<div class="cn-metadata"><div>Injection</div>

<div>Cross Site Scripting</div>

<div>Cross Site Request Forgery</div>

<div>Buffer Overflow</div>

</div>

<span class="atom-code hidden">bb1840e4-5425-49a3-9d75-477b8f016ff8</span>

<p id="cn-m18-7">Welcome to the <b>Identifying Different Application Exploits </b>Practice Lab. In this module, you will be provided with the instructions and devices needed to develop your hands-on skills.</p>

<span class="atom-code hidden">dc640c20-9434-45ea-b7c2-6d4d6a196bfc</span>

<h2 class="cn-learningobjectives"><b>Learning Outcomes</b></h2>

<p id="cn-m18-11">In this module, you will complete the following exercises:</p>

<ul id="cn-m18-12">

<li id="cn-m18-12">Exercise 1 - Cross Site Scripting</li>

<li id="cn-m18-13">Exercise 2 - SQL Injection</li>

<li id="cn-m18-14">Exercise 3 - Information Leakage and Improper Error Handling</li>

<li id="cn-m18-15">Exercise 4 - Race Conditions, Memory Leak, Resource Exhaustion and Overflow Attacks</li>

<li id="cn-m18-16">Exercise 5 - Directory Traversal and Path Manipulation</li>

<li id="cn-m18-17">Exercise 6 - Privilege Escalation</li>

<li id="cn-m18-18">Exercise 7 - Driver Manipulation and Replay Attacks</li>

<li id="cn-m18-19">Exercise 8 - Pass the Hash, API Attacks, Request Forgeries, Pointer Dereference and SSL Stripping</li>

</ul>

<p id="cn-m18-20">After completing this module, you should be able to:</p>

<ul id="cn-m18-21">

<li id="cn-m18-21">Exploit Reflected XSS Attacks</li>

<li id="cn-m18-22">Exploit Error-Based SQL Injection</li>

<li id="cn-m18-23">Gather Information from Exception Messages</li>

<li id="cn-m18-24">Identify Buffer Overflow</li>

<li id="cn-m18-25">Exploit Directory Listing Vulnerability</li>

<li id="cn-m18-26">Perform Vertical Privilege Escalation</li>

<li id="cn-m18-27">Perform Cross Site Request Forgery</li>

</ul>

<p id="cn-m18-29">After completing this module, you should have further knowledge of:</p>

<ul id="cn-m18-30">

<li id="cn-m18-30">Types of XSS Attacks</li>

<li id="cn-m18-31">Error Based SQL Injection</li>

<li id="cn-m18-32">Device Manipulation and Replay Attacks</li>

<li id="cn-m18-33">API Attacks, Pointer Dereference, Pass the Hash and SSL Stripping</li>

</ul>

<h2 class="cn-examobjectives"><b>Exam Objectives</b></h2>

<p id="cn-m18-35">The following exam objectives are covered in this lab:</p>

<p id="cn-m18-36">1.3 Given a scenario, analyze potential indicators associated with application attacks.</p>

<ul id="cn-m18-37">

<li id="cn-m18-37">Privilege Escalation</li>

<li id="cn-m18-38">Cross-site Scripting</li>

<li id="cn-m18-39">Injections</li>

<li id="cn-m18-40">Pointer/Object Dereference</li>

<li id="cn-m18-41">Directory Traversal</li>

<li id="cn-m18-42">Buffer Overflows</li>

<li id="cn-m18-43">Race Conditions</li>

<li id="cn-m18-44">Error Handling</li>

<li id="cn-m18-45">Improper Input Handling</li>

<li id="cn-m18-46">Replay Attack</li>

<li id="cn-m18-47">Integer Overflow</li>

<li id="cn-m18-48">Request Forgeries</li>

<li id="cn-m18-49">Application Programming Interface (API) Attacks</li>

<li id="cn-m18-50">Resource Exhaustion</li>

<li id="cn-m18-51">Memory Leak</li>

<li id="cn-m18-52">Secure Sockets Layer (SSL) Stripping</li>

<li id="cn-m18-53">Driver Manipulation</li>

<li id="cn-m18-54">Pass the Hash</li>

</ul>

<span class="cn-quote" id="cn-m18-55"><b><i>Note: </i></b><i>Our main 
focus is to cover the practical, hands-on aspects of the exam 
objectives. We recommend referring to course material or a search engine
 to research theoretical topics in more detail.</i></span>

<h2 class="cn-labduration"><b>Lab Duration</b></h2>

<p id="cn-m18-57">It will take approximately <b>1 hour </b>to complete this lab.</p>

<span class="atom-code hidden">c6fa62a3-1a00-4052-8104-258e8cbaa187</span>

<h2 class="cn-helpdandsupport"><b>Help and Support</b></h2>

<p id="cn-m18-61">For more information on using Practice Labs, please see our <b>Help and Support </b>page. You can also raise a technical support ticket from this page.</p>

<span class="cn-alert" id="cn-m18-62">Click <b>Next </b>to view the Lab topology used in this module.</span>

<span class="atom-code hidden">d2c53300-f951-45a9-9aa4-3d4ecae69e11</span>

<div class="print-exercise-break"></div><h2 class="exercise-title" id="cn-m18-65"><b>Lab Topology</b></h2>

<p id="cn-m18-66">During your session, you will have access to the following lab configuration.</p>

<p id="cn-m18-67"><img class="cn-img" id="cn-image-m18-c-0" src="IdentifyingDifferentApplicationExploits_files/image-m18-c-0.jpg" alt="Practice Labs screenshot."></p>

<p id="cn-m18-68">Depending on the exercises, you may or may not use all
 of the devices, but they are shown here in the layout to get an overall
 understanding of the topology of the lab.</p>

<ul id="cn-m18-69">

<li id="cn-m18-69"><b>PLABDC01 </b>- Windows Server 2019 (Domain Controller)</li>

<li id="cn-m18-70"><b>PLABDM01 </b>- Windows Server 2019 (Domain Member Server)</li>

<li id="cn-m18-71"><b>PLABWIN10 </b>- Windows 10 (Domain Member Workstation)</li>

<li id="cn-m18-72"><b>PLABKALI </b>- Kali 2019.4 (Stand-alone device)</li>

</ul>

<span class="cn-alert" id="cn-m18-73">Click <b>Next </b>to proceed to the first exercise.</span>
< <a href="https://github.com/SeanOhAileasa" id="CrossSiteScripting">Home</a> | <a href="https://github.com/SeanOhAileasa/syp-practice-labs/blob/main/README.md">README</a> > 
<h2>CompTIA Security+ Practice Labs</h2>
<div class="print-exercise-break"></div><h2 class="exercise-title" id="cn-m18-74"><b>Exercise 1 - Cross Site Scripting</b></h2>

<p id="cn-m18-75">In this exercise, you will learn about cross site 
scripting vulnerabilities, types and how it affects web applications. 
The reason behind this exploitation or manipulation is to gather 
sensitive information like session cookies, session tokens and 
additional information that persists on the user’s browser.</p>

<h2 class="cn-learningobjectives"><b>Learning Outcomes</b></h2>

<p id="cn-m18-77">After completing this exercise, you should be able to:</p>

<ul id="cn-m18-78">

<li id="cn-m18-78">Exploit Reflected XSS Attacks</li>

</ul>

<p id="cn-m18-79">After completing this exercise, you should have further knowledge of:</p>

<ul id="cn-m18-80">

<li id="cn-m18-80">Identifying Types of XSS Attacks</li>

</ul>

<h2 class="cn-devices"><b>Your Devices </b></h2>

<p id="cn-m18-82">You will be using the following device in this exercise. Please power this on now.</p>

<ul id="cn-m18-83">

<li id="cn-m18-83"><b>PLABKALI </b>- Kali 2019.4 (Stand-alone device)</li>

</ul>

<p id="cn-m18-84"><img class="cn-img" id="cn-image-m18-c-1" src="IdentifyingDifferentApplicationExploits_files/image-m18-c-1.jpg" alt="Practice Labs screenshot."></p>

<h3 id="cn-m18-85"><b>Identifying Types of XSS Attacks</b></h3>

<p id="cn-m18-86">Cross-site scripting (XSS) is a common web application
 vulnerability. When exploited, it often results in an execution of 
malicious scripts on the victim’s browser.</p>

<p id="cn-m18-87">Web pages usually contain static text and dynamic 
content that has scripts and/or code. The web browser authorizes and 
allows the execution of scripts that originate only from the same 
domain. This practice is typically called the “Same Origin Policy” . 
Positive exploitation or manipulation of a Cross-Site Scripting 
vulnerability occurs by tricking the same-origin policy's web browser. A
 typical XSS exploit happens when malicious scripts enter the web 
application via an untrusted source, which is then transmitted to the 
webserver. The web server will then respond appropriately. Hackers 
formulate the request so that the injected script is returned along with
 the response from the server. On an interpretation of the server’s 
response by the web browser, the malicious script gets executed, 
resulting in the exposure of sensitive information.</p>

<h4 id="cn-m18-88"><b><i>Types of XSS Attacks</i></b></h4>

<p id="cn-m18-89">The three common cross site scripting attacks are:</p>

<ul id="cn-m18-90">

<li id="cn-m18-90">Reflected Cross Site Scripting</li>

<li id="cn-m18-91">Stored Cross Site Scripting</li>

<li id="cn-m18-92">DOM Based Cross Site Scripting</li>

</ul>

<h4 id="cn-m18-93"><b><i>Reflected Cross Site Scripting</i></b></h4>

<p id="cn-m18-94">Reflected cross site scripting attacks are the most 
common form of XSS attacks. This type of attack is also called 
non-persistent XSS attacks since the malicious script is not stored 
permanently in the database or the server. In a typical attack scenario,
 the attacker injects malicious scripts into any of the input fields or 
parameters. The application accepts the malicious input and then 
transfers it to the server via the HTTP request. In response to the HTTP
 request, the webserver returns a HTTP response.</p>

<p id="cn-m18-95">In most cases, the injected script is returned as part
 of the HTTP response. The web browser receives the server's response 
and interprets it as a trusted response from the server. This results in
 the execution of the malicious script.</p>

<p id="cn-m18-96">The array of events that occur in a successful reflected XSS real-life exploit is as follows:</p>

<p id="cn-m18-97">1. The user logs in to the application</p>

<p id="cn-m18-98">2. The user sends a reliable HTTP request to the server</p>

<p id="cn-m18-99">3. The attacker seizes the request and crafts a 
malicious request (by injecting scripts) by altering any of the input 
parameters.</p>

<p id="cn-m18-100">4. The attacker forwards the request to the server</p>

<p id="cn-m18-101">5. The server sends a HTTP response for the malicious request</p>

<p id="cn-m18-102">6. The injected script gets executed in the user’s browser</p>

<p id="cn-m18-103">7. Then, sensitive facts are returned to the attacker via execution of the injected script</p>

<h4 id="cn-m18-104"><b><i>Stored XSS</i></b></h4>

<p id="cn-m18-105">Stored cross site scripting is otherwise called 
persistent cross site scripting. In a stored cross site scripting 
attack, the malicious script supplied by the attacker is stored either 
on the web server or the database. The script is then executed at a 
later stage when the user requests another web page that fetches data 
from the database or the webserver. Unlike reflected XSS, stored XSS 
might affect more than one valid user if the malicious script injected 
is stored in a common database table and is requested by multiple users 
of the application.</p>

<h4 id="cn-m18-106"><b><i>DOM Based XSS</i></b></h4>

<p id="cn-m18-107">Web applications frequently use client side 
JavaScript functions for various purposes like validating the user 
inputs before the request reaches the server, for performance reasons, 
reducing processing overhead etc. If a client side JavaScript function 
fails, the HTTP request will not be sent to the server and an error 
message is immediately thrown to the end-user. Any loophole in the 
client side JavaScript function can be utilized by the attacker to 
exploit a DOM based XSS attack. This attack is thus said to affect the 
Document Object Model of the web browser.</p>

<p id="cn-m18-108">For example, the below html tag is used for accepting a username from the end-user:</p>

<pre id="cn-m18-109"><code>&lt;input type=”text” name=”username” value=”user supplied input”/&gt;

</code></pre>

<p id="cn-m18-111">Suppose a client side validation function similar to 
the one below checks for malicious characters in the input and displays 
back an error message along with the user supplied data. In that case, 
the page is said to be vulnerable to XSS attack.</p>

<pre id="cn-m18-113"><code>var validateInput(String input){

if(input.hasCharacters(“’;&lt;&gt;”)){

document.write(“Special characters not allowed on input fields”, input);

} }

</code></pre>

<p id="cn-m18-118">Now, if the malicious user supplies 
&lt;script&gt;alert(100)&lt;/script&gt; as input, since the validation 
function writes back the input, the script gets executed on the web 
browser. Note that the request is not being sent to the server, and 
thus, it is differentiated from a reflected XSS attack.</p>

<h3 id="cn-m18-119"><b>Task 1 - Exploit Reflected XSS Attacks</b></h3>

<p id="cn-m18-120">This task provides simple payloads and malicious 
scripts to identify and exploit reflected cross site scripting 
vulnerabilities in the search bar of an application.</p>

<p id="cn-m18-121">In this task, you will exploit a reflected cross site scripting vulnerability on a demo application.</p>

<h4 id="cn-m18-122"><b><i>Step 1 </i></b></h4>

<p id="cn-m18-123">Connect to <b>PLABKALI</b>.</p>

<p id="cn-m18-124"></p><figure><img class="cn-img" id="cn-image-m18-c-2" src="IdentifyingDifferentApplicationExploits_files/image-m18-c-2.jpg" alt="Figure 1.1 Screenshot of PLABKALI"><figcaption>Figure 1.1 Screenshot of PLABKALI: Displaying the login screen.</figcaption></figure><p></p>

<h4 id="cn-m18-125"><b><i>Step 2</i></b></h4>

<p id="cn-m18-126">Log in with the following credentials:</p>

<p id="cn-m18-127"><b>Username:</b></p>

<pre id="cn-m18-128"><code>root

</code></pre>

<p id="cn-m18-129"><b>Password: </b></p>

<span class="cn-password"><span class="cn-password">Passw0rd</span></span>

<p id="cn-m18-131"></p><figure><img class="cn-img" id="cn-image-m18-c-3" src="IdentifyingDifferentApplicationExploits_files/image-m18-c-3.jpg" alt="Figure 1.2 Screenshot of PLABKALI"><figcaption>Figure 1.2 Screenshot of PLABKALI: Displaying logging into the kali device as the root user.</figcaption></figure><p></p>

<h4 id="cn-m18-132"><b><i>Step 3</i></b></h4>

<p id="cn-m18-133">Click on the <b>Kali dragon </b>icon and click on <b>Web Browser </b>from the drop-down menu.</p>

<p id="cn-m18-134"></p><figure><img class="cn-img" id="cn-image-m18-c-4" src="IdentifyingDifferentApplicationExploits_files/image-m18-c-4.jpg" alt="Figure 1.3 Screenshot of PLABKALI"><figcaption>Figure 1.3 Screenshot of PLABKALI: Displaying opening a web browser from the desktop.</figcaption></figure><p></p>

<h4 id="cn-m18-135"><b><i>Step 4</i></b></h4>

<p id="cn-m18-136">In the <b>Firefox </b>web browser, browse to the following URL:</p>

<pre id="cn-m18-137"><code>https://demo.testfire.net

</code></pre>

<p id="cn-m18-139"></p><figure><img class="cn-img" id="cn-image-m18-c-5" src="IdentifyingDifferentApplicationExploits_files/image-m18-c-5.jpg" alt="Figure 1.4 Screenshot of PLABKALI"><figcaption>Figure 1.4 Screenshot of PLABKALI: Displaying browsing to the website using the Firefox browser.</figcaption></figure><p></p>

<h4 id="cn-m18-140"><b><i>Step 5</i></b></h4>

<p id="cn-m18-141">In the <b>Firefox </b>browser, select Advanced.</p>

<p id="cn-m18-142"></p><figure><img class="cn-img" id="cn-image-m18-c-6" src="IdentifyingDifferentApplicationExploits_files/image-m18-c-6.jpg" alt="Figure 1.5 Screenshot of PLABKALI"><figcaption>Figure 1.5 Screenshot of PLABKALI: Displaying browsing to the website using the Firefox browser.</figcaption></figure><p></p>

<h4 id="cn-m18-143"><b><i>Step 6</i></b></h4>

<p id="cn-m18-144">Click <b>Accept the Risk and Continue</b>.</p>

<p id="cn-m18-145"></p><figure><img class="cn-img" id="cn-image-m18-c-7" src="IdentifyingDifferentApplicationExploits_files/image-m18-c-7.jpg" alt="Figure 1.6 Screenshot of PLABKALI"><figcaption>Figure 1.6 Screenshot of PLABKALI: Displaying browsing to the website using the Firefox browser.</figcaption></figure><p></p>

<h4 id="cn-m18-146"><b><i>Step 7</i></b></h4>

<p id="cn-m18-147">Select Sign in and log in to the application using the following credentials:</p>

<p id="cn-m18-148"><b>Username</b></p>

<pre id="cn-m18-149"><code>admin

</code></pre>

<p id="cn-m18-150"><b>Password</b></p>

<span class="cn-password">admin</span>

<p id="cn-m18-152">Click <b>Login</b>.</p>

<p id="cn-m18-153"></p><figure><img class="cn-img" id="cn-image-m18-c-8" src="IdentifyingDifferentApplicationExploits_files/image-m18-c-8.jpg" alt="Figure 1.7 Screenshot of PLABKALI"><figcaption>Figure 1.7 Screenshot of PLABKALI: Displaying the application is launched, and credentials supplied to log in.</figcaption></figure><p></p>

<h4 id="cn-m18-154"><b><i>Step 8</i></b></h4>

<p id="cn-m18-155">In the search box type:</p>

<pre id="cn-m18-156"><code>&lt;script&gt;alert(100)&lt;/script&gt;

</code></pre>

<p id="cn-m18-158">Press <b>Enter</b>.</p>

<p id="cn-m18-159">Since the application is vulnerable to cross-site scripting, the supplied script executes and an alert is thrown up.</p>

<p id="cn-m18-160">Click <b>OK </b>on the pop-up window.</p>

<p id="cn-m18-161"></p><figure><img class="cn-img" id="cn-image-m18-c-9" src="IdentifyingDifferentApplicationExploits_files/image-m18-c-9.jpg" alt="Figure 1.8 Screenshot of PLABKALI"><figcaption>Figure 1.8 Screenshot of PLABKALI: Displaying the web application is vulnerable to a Cross Site Scripting attack.</figcaption></figure><p></p>

<h4 id="cn-m18-162"><b><i>Step 9</i></b></h4>

<p id="cn-m18-163">To exploit this vulnerability, type the following into the search bar:</p>

<pre id="cn-m18-164"><code>&lt;script&gt;alert(document.cookie)&lt;/script&gt;

</code></pre>

<p id="cn-m18-165">Press <b>Enter</b>.</p>

<p id="cn-m18-166">The cookie value is now displayed in the alert box.</p>

<p id="cn-m18-168"></p><figure><img class="cn-img" id="cn-image-m18-c-10" src="IdentifyingDifferentApplicationExploits_files/image-m18-c-10.jpg" alt="Figure 1.9 Screenshot of PLABKALI"><figcaption>Figure 1.9 Screenshot of PLABKALI: Displaying the captured cookie on the web page.</figcaption></figure><p></p>

<span class="atom-code hidden">80e3ace3-3818-477e-9d50-9fdfea66eb75</span>

<p id="cn-m18-172">Click <b>OK</b>.</p>

<h4 id="cn-m18-173"><b><i>Step 10</i></b></h4>

<p id="cn-m18-174">Click <b>Sign off</b>.</p>

<p id="cn-m18-175"></p><figure><img class="cn-img" id="cn-image-m18-c-11" src="IdentifyingDifferentApplicationExploits_files/image-m18-c-11.jpg" alt="Figure 1.10 Screenshot of PLABKALI"><figcaption>Figure 1.10 Screenshot of PLABKALI: Displaying logging out of the web application.</figcaption></figure><p></p>

<p id="cn-m18-176">Keep <b>Firefox </b>and the webpage open.</p>

<span class="cn-alert" id="cn-m18-177">Leave all devices in their current state and proceed to the next exercise.</span>
< <a href="https://github.com/SeanOhAileasa" id="SQLInjection">Home</a> | <a href="https://github.com/SeanOhAileasa/syp-practice-labs/blob/main/README.md">README</a> > 
<h2>CompTIA Security+ Practice Labs</h2>
<div class="print-exercise-break"></div><h2 class="exercise-title" id="cn-m18-179"><b>Exercise 2 - SQL Injection</b></h2>

<p id="cn-m18-180">An SQL injection vulnerability occurs when a 
malicious user or attacker injects special characters into the 
application's input fields. Any application that fails to apply a 
validation or implements a poor validation technique is susceptible to 
SQL injection vulnerabilities. The attacker's malicious inputs are now 
inserted into a SQL query parameter, which in turn is considered for 
execution by the database engine. The database interpreter considers the
 inserted special characters as SQL commands rather than malicious 
special characters. As a result of the execution of a query with 
malicious user-supplied data, sensitive information is fetched from the 
database and displayed on the front end.</p>

<p id="cn-m18-181">In this exercise, you will learn about types of SQL injections and will also exploit an error-based SQL injection.</p>

<h2 class="cn-learningobjectives"><b>Learning Outcomes</b></h2>

<p id="cn-m18-183">After completing this exercise, you should be able to:</p>

<ul id="cn-m18-184">

<li id="cn-m18-184">Exploit Error-Based SQL Injection</li>

</ul>

<p id="cn-m18-185">After completing this exercise, you should have further knowledge of:</p>

<ul id="cn-m18-186">

<li id="cn-m18-186">Error Based SQL Injection</li>

</ul>

<h2 class="cn-devices"><b> Your Devices </b></h2>

<p id="cn-m18-188">You will be using the following device in this exercise. Please power this on now.</p>

<ul id="cn-m18-189">

<li id="cn-m18-189"><b>PLABKALI </b>- Kali 2019.4 (Stand-alone device)</li>

</ul>

<p id="cn-m18-190"><img class="cn-img" id="cn-image-m18-c-12" src="IdentifyingDifferentApplicationExploits_files/image-m18-c-12.jpg" alt="Practice Labs screenshot."></p>

<h3 id="cn-m18-191"><b>Error Based SQL Injection</b></h3>

<p id="cn-m18-192">There are different types of SQL injections. 
Identification and classification types are done by analyzing the 
behavior of the application.</p>

<p id="cn-m18-193">In this task, you will learn about the different types of SQL Injections.</p>

<h4 id="cn-m18-194"><b><i>Types of SQL Injection</i></b></h4>

<p id="cn-m18-195">SQL injection types can be classified based on 
criteria like a response from the database server, injection order, type
 of input, etc.</p>

<p id="cn-m18-196">The common attack types are as follows:</p>

<ul id="cn-m18-197">

<li id="cn-m18-197">Error Based SQL Injection</li>

<li id="cn-m18-198">Blind SQL Injection</li>

<li id="cn-m18-199">Second Order Injection</li>

</ul>

<p id="cn-m18-200">Error-based SQL injection attack confirms the 
vulnerability by revealing database-specific exceptions or error 
messages to the end-user or attacker. The database exception message 
thrown back by the database server in response to the malicious SQL 
query returns sensitive information like table names, column names, 
database name, version of SQL, class names or namespaces pertaining to 
the language in which the application is developed.</p>

<p id="cn-m18-201">Below is an example of a database error message:</p>

<span class="cn-alert" id="cn-m18-202">Syntax error (missing operator) in query expression ‘username=”’ AND password=’dsd”.</span>

<h4 id="cn-m18-203"><b><i>Blind SQL Injection</i></b></h4>

<p id="cn-m18-204">Unlike a normal SQL injection exploit, a Blind SQL 
Injection exploit occurs by constructing the SQL query so that the 
database execution engine is made to answer a few yes or no questions. 
The type of response by the database server allows an attacker to 
confirm the existence of an SQL injection vulnerability. Usually, an 
attacker attempts to do a Blind SQL Injection attack when a normal SQL 
injection exploit is impossible, due to the application error handling 
mechanisms. In general, applications might choose to display generic 
error messages instead of database-specific error messages to prevent 
the exposure of sensitive information. A blind SQL injection exploit 
bypasses this error handling mechanism of the application.</p>

<p id="cn-m18-205">For example, consider a simple page that displays the
 product name and product description given the product id as an input. 
The underlying query will look like the one below:</p>

<pre id="cn-m18-206"><code>Select product_name, product_description from PRODUCTS where product_id=1;

</code></pre>

<p id="cn-m18-207">The above query returns the details about the product
 based on the ID that is supplied. The attacker can now try to inject 
the database with a query that will return a false result as&nbsp;per 
the example below:</p>

<pre id="cn-m18-208"><code>Select product_name, product_description from PRODUCTS where product_id=1 and 1=2;

</code></pre>

<p id="cn-m18-209">If the application is vulnerable to blind SQL 
injection attack, the database server will not return any records in 
response to the above query since 1=2 is always false.</p>

<p id="cn-m18-210">The attacker will analyze the behavior of the 
application to different queries. Even if the application properly 
handles error messages, failure to validate input fields can lead to an 
SQL injection attack and this can be identified by the attacker by 
performing a blind SQL injection attack.</p>

<h4 id="cn-m18-211"><b><i>Second Order SQL Injection</i></b></h4>

<p id="cn-m18-212">Second Order SQL Injection vulnerabilities occur when
 the attacker's malicious input is stored in the database table and is 
used as an input parameter in a different SQL query in a different 
place.</p>

<p id="cn-m18-213">For example, the inputs (username, password) supplied
 in the user registration page are usually stored in the database table.
 When the user tries to change his/her password, the corresponding SQL 
query will be similar to the one given below:</p>

<pre id="cn-m18-214"><code>alter table USERS modify password=”new password value” where user_name=”existing value stored in the database” and password=”current_password”;

</code></pre>

<p id="cn-m18-215">The user_name field in general for the above query is
 fetched from the value already stored in the database. An application 
that fails to validate user-supplied values will store malicious data in
 the database table, resulting in second-order injection attacks.</p>

<h3 id="cn-m18-216"><b>Task 1 - Exploit Error-Based SQL Injection</b></h3>

<p id="cn-m18-217">An error-based SQL injection vulnerability can be 
exploited by inserting a SQL special character (comma, single quotes, 
double quotes, semicolon, hyphen etc.) into any of the input fields. A 
vulnerable application fails to filter the malicious input and it takes 
this input to the database layer post translating the input into a SQL 
query that can be interpreted by the database engine.</p>

<p id="cn-m18-218">In this task, you will learn ways to exploit 
error-based SQL injection. This task provides simple payloads and 
malicious inputs to identify and exploit error-based SQL injections in 
the login page of an application.</p>

<h4 id="cn-m18-219"><b><i>Step 1 </i></b></h4>

<p id="cn-m18-220">Connect to <b>PLABKALI</b>.</p>

<p id="cn-m18-221">Ensure that the Firefox browser is open and the following web page is open:</p>

<pre id="cn-m18-222"><code>https://demo.testfire.net/login.jsp

</code></pre>

<p id="cn-m18-223"></p><figure><img class="cn-img" id="cn-image-m18-c-13" src="IdentifyingDifferentApplicationExploits_files/image-m18-c-13.jpg" alt="Figure 2.1 Screenshot of PLABKALI"><figcaption>Figure 2.1 Screenshot of PLABKALI: Displaying the Firefox web browser with the open web application.</figcaption></figure><p></p>

<h4 id="cn-m18-224"><b><i>Step 2</i></b></h4>

<p id="cn-m18-225">Click <b>Sign in </b>on the web application.</p>

<p id="cn-m18-226"></p><figure><img class="cn-img" id="cn-image-m18-c-14" src="IdentifyingDifferentApplicationExploits_files/image-m18-c-14.jpg" alt="Figure 2.2 Screenshot of PLABKALI"><figcaption>Figure 2.2 Screenshot of PLABKALI: Displaying logging into the web application.</figcaption></figure><p></p>

<h4 id="cn-m18-227"><b><i>Step 3 </i></b></h4>

<p id="cn-m18-228">On the <b>Online Banking Login </b>page, enter the following:</p>

<p id="cn-m18-229"><b>Username: </b></p>

<pre id="cn-m18-230"><code>admin’ or 1=1--

</code></pre>

<p id="cn-m18-231"><b>Password:</b></p>

<span class="cn-password">asdfg</span>

<p id="cn-m18-233">Click <b>Login.</b></p>

<p id="cn-m18-235"></p><figure><img class="cn-img" id="cn-image-m18-c-15" src="IdentifyingDifferentApplicationExploits_files/image-m18-c-15.jpg" alt="Figure 2.3 Screenshot of PLABKALI"><figcaption>Figure 2.3 Screenshot of PLABKALI: Displaying entering the login credentials.</figcaption></figure><p></p>

<h4 id="cn-m18-236"><b><i>Step 4 </i></b></h4>

<p id="cn-m18-237">Since the application is vulnerable to SQL injection, the <b>admin’  or 1=1 </b>condition
 is always true and as per SQL syntax, anything after ‘--‘ is ignored. 
Hence the random password value is ignored and the application allows 
successful login to the application.</p>

<p id="cn-m18-239"></p><figure><img class="cn-img" id="cn-image-m18-c-16" src="IdentifyingDifferentApplicationExploits_files/image-m18-c-16.jpg" alt="Figure 2.4 Screenshot of PLABKALI"><figcaption>Figure
 2.4 Screenshot of PLABKALI: Displaying the webpage with the welcome 
page after the user logged in to the application using sql injection, 
bypassing authentication logic.</figcaption></figure><p></p>

<span class="atom-code hidden">80e3ace3-3818-477e-9d50-9fdfea66eb75</span>

<h4 id="cn-m18-242"><b><i>Step 5</i></b></h4>

<p id="cn-m18-243">Click <b>Sign Off </b>to logout of the application.</p>

<p id="cn-m18-244"></p><figure><img class="cn-img" id="cn-image-m18-c-17" src="IdentifyingDifferentApplicationExploits_files/image-m18-c-17.jpg" alt="Figure 2.5 Screenshot of PLABKALI"><figcaption>Figure 2.5 Screenshot of PLABKALI: Displaying signing out of the application.</figcaption></figure><p></p>

<p id="cn-m18-245">Keep <b>Firefox </b>and the web page open for the next exercise.</p>

<span class="cn-alert" id="cn-m18-246">Leave all devices in their current state and proceed to the next exercise.</span>
< <a href="https://github.com/SeanOhAileasa" id="InformationLeakageandImproperErrorHandling">Home</a> | <a href="https://github.com/SeanOhAileasa/syp-practice-labs/blob/main/README.md">README</a> > 
<h2>CompTIA Security+ Practice Labs</h2>
<div class="print-exercise-break"></div><h2 class="exercise-title" id="cn-m18-249"><b>Exercise 3 - Information Leakage and Improper Error Handling</b></h2>

<p id="cn-m18-250">Handling application exceptions improperly can 
provide a ton of information to an attacker that can be used to perform 
additional exploits. Most often, attackers try to evade applications 
only via the initial set of information exposed while conducting 
reconnaissance or passive scanning of an application.</p>

<p id="cn-m18-251">In this exercise, you will gather information from exception messages that are generated.</p>

<h2 class="cn-learningobjectives"><b>Learning Outcomes</b></h2>

<p id="cn-m18-253">After completing this exercise, you should be able to:</p>

<ul id="cn-m18-254">

<li id="cn-m18-254">Gather Information from Exception Messages</li>

</ul>

<h2 class="cn-devices"><b>Your Devices </b></h2>

<p id="cn-m18-256">You will be using the following device in this exercise. Please power this on now.</p>

<ul id="cn-m18-257">

<li id="cn-m18-257"><b>PLABKALI </b>- Kali 2019.4 (Stand-alone device)</li>

</ul>

<p id="cn-m18-258"><img class="cn-img" id="cn-image-m18-c-18" src="IdentifyingDifferentApplicationExploits_files/image-m18-c-18.jpg" alt="Practice Labs screenshot."></p>

<h3 id="cn-m18-259"><b>Task 1 - Gather Information from Exception Messages</b></h3>

<p id="cn-m18-260">Information leakage discloses information that could 
be sensitive and confidential, allowing attackers to advance their 
schemes. Most often, attackers try to attack applications only via the 
initial set of information exposed while conducting reconnaissance or 
passive scanning of an application.</p>

<p id="cn-m18-262">In this task, you will learn how to uncover simple information leakage techniques that allow you to gather information.</p>

<h4 id="cn-m18-263"><b><i>Step 1 </i></b></h4>

<p id="cn-m18-264">Connect to <b>PLABKALI</b>.</p>

<p id="cn-m18-265">Ensure the web page from the previous exercise is still open.</p>

<p id="cn-m18-266">Click <b>Sign in</b></p>

<p id="cn-m18-267"></p><figure><img class="cn-img" id="cn-image-m18-c-19" src="IdentifyingDifferentApplicationExploits_files/image-m18-c-19.jpg" alt="Figure 3.1 Screenshot of PLABKALI"><figcaption>Figure 3.1 Screenshot of PLABKALI: Displaying clicking Sign In on the web page.</figcaption></figure><p></p>

<h4 id="cn-m18-268"><b><i>Step 2</i></b></h4>

<p id="cn-m18-269">Enter the following credentials:</p>

<p id="cn-m18-270"><b>Username:</b></p>

<pre id="cn-m18-271"><code>admin

</code></pre>

<p id="cn-m18-272"><b>Password: </b></p>

<span class="cn-password">admin</span>

<p id="cn-m18-274">Click <b>Login.</b></p>

<p id="cn-m18-275"></p><figure><img class="cn-img" id="cn-image-m18-c-20" src="IdentifyingDifferentApplicationExploits_files/image-m18-c-20.jpg" alt="Figure 3.2 Screenshot of PLABKALI"><figcaption>Figure 3.2 Screenshot of PLABKALI: Displaying logging into the web application.</figcaption></figure><p></p>

<h4 id="cn-m18-276"><b><i>Step 3 </i></b></h4>

<p id="cn-m18-277">Click on the <b>View Recent Transactions </b>link under the <b>I WANT TO … </b>section in the left pane of the web page.</p>

<p id="cn-m18-278"></p><figure><img class="cn-img" id="cn-image-m18-c-21" src="IdentifyingDifferentApplicationExploits_files/image-m18-c-21.jpg" alt="Figure 3.3 Screenshot of PLABKALI"><figcaption>Figure 3.3 Screenshot of PLABKALI: Displaying selecting View Recent Transactions on the web site.</figcaption></figure><p></p>

<h4 id="cn-m18-279"><b><i>Step 4</i></b></h4>

<p id="cn-m18-280">On the input fields, insert the following dates:</p>

<p id="cn-m18-281"><b>After</b></p>

<pre id="cn-m18-282"><code>2005-10-01

</code></pre>

<p id="cn-m18-283"><b>Before</b></p>

<pre id="cn-m18-284"><code> 2006-10-01 u

</code></pre>

<p id="cn-m18-285">Click <b>Submit</b>.</p>

<p id="cn-m18-286"></p><figure><img class="cn-img" id="cn-image-m18-c-22" src="IdentifyingDifferentApplicationExploits_files/image-m18-c-22.jpg" alt="Figure 3.4 Screenshot PLABKALI"><figcaption>Figure 3.4 Screenshot PLABKALI: Displaying the Recent transaction page and changing the date range.</figcaption></figure><p></p>

<h4 id="cn-m18-287"><b><i>Step 5 </i></b></h4>

<p id="cn-m18-288">Since the application does not handle inputs 
properly, a detailed exception is thrown that reveals underlying 
database information.</p>

<p id="cn-m18-290"></p><figure><img class="cn-img" id="cn-image-m18-c-23" src="IdentifyingDifferentApplicationExploits_files/image-m18-c-23.jpg" alt="Figure 3.5 Screenshot of PLABKALI"><figcaption>Figure 3.5 Screenshot of PLABKALI: Displaying an Exception Report page exposing the server details.</figcaption></figure><p></p>

<span class="atom-code hidden">80e3ace3-3818-477e-9d50-9fdfea66eb75</span>

<h4 id="cn-m18-293"><b><i>Step 6</i></b></h4>

<p id="cn-m18-294">Close the <b>Firefox </b>web browser.</p>

<p id="cn-m18-295"></p><figure><img class="cn-img" id="cn-image-m18-c-24" src="IdentifyingDifferentApplicationExploits_files/image-m18-c-24.jpg" alt="Figure 3.6 Screenshot of PLABKALI"><figcaption>Figure 3.6 Screenshot of PLABKALI: Displaying closing the Firefox web browser.</figcaption></figure><p></p>

<span class="cn-alert" id="cn-m18-296">Leave all devices in their current state and proceed to the next exercise.</span>
< <a href="https://github.com/SeanOhAileasa" id="RaceConditionsMemoryLeakResourceExhaustionandOverflowAttacks">Home</a> | <a href="https://github.com/SeanOhAileasa/syp-practice-labs/blob/main/README.md">README</a> > 
<h2>CompTIA Security+ Practice Labs</h2>
<div class="print-exercise-break"></div><h2 class="exercise-title" id="cn-m18-298"><b>Exercise 4 - Race Conditions, Memory Leak, Resource Exhaustion and Overflow Attacks</b></h2>

<p id="cn-m18-299">A race condition occurs when an application processes
 multiple operations simultaneously, causing failures in execution or 
potentially overwriting user information, resulting in integrity 
concerns with data. Overflow attacks occur when the application fails to
 release memory locations held by objects, pointers and other variables 
assigned with a memory address or accepts more input than it can handle.
 The attacker might launch a buffer overflow or a denial of service 
attack. The application might behave in unexpected ways due to a 
read/write out of allocated memory bounds. A memory leak in specific 
discloses sensitive information that is previously written into memory 
blocks. One or more of the above-explained vulnerabilities could result 
in complete resource exhaustion.</p>

<p id="cn-m18-300">In this exercise, you will learn to identify a buffer overflow.</p>

<h2 class="cn-learningobjectives"><b>Learning Outcomes</b></h2>

<p id="cn-m18-302">After completing this exercise, you should be able to:</p>

<ul id="cn-m18-303">

<li id="cn-m18-303">Identify Buffer Overflow</li>

</ul>

<h2 class="cn-devices"><b>Your Devices </b></h2>

<p id="cn-m18-305">You will be using the following device in this exercise. Please power this on now.</p>

<ul id="cn-m18-306">

<li id="cn-m18-306"><b>PLABKALI </b>- Kali 2019.4 (Stand-alone device)</li>

</ul>

<p id="cn-m18-307"><img class="cn-img" id="cn-image-m18-c-25" src="IdentifyingDifferentApplicationExploits_files/image-m18-c-25.jpg" alt="Practice Labs screenshot."></p>

<h3 id="cn-m18-308"><b>Task 1 - Identify Buffer Overflow</b></h3>

<h4 id="cn-m18-309"><b><i>Step 1  </i></b></h4>

<p id="cn-m18-310">Connect to <b>PLABKALI</b>.</p>

<p id="cn-m18-311">Launch <b>Firefox </b>and navigate to:</p>

<pre id="cn-m18-313"><code>https://demo.testfire.net

</code></pre>

<p id="cn-m18-315"></p><figure><img class="cn-img" id="cn-image-m18-c-26" src="IdentifyingDifferentApplicationExploits_files/image-m18-c-26.jpg" alt="Figure 4.1 Screenshot of PLABKALI"><figcaption>Figure 4.1 Screenshot of PLABKALI: Displaying the Kali menu options and the Web Browser option selected.</figcaption></figure><p></p>

<h4 id="cn-m18-316"><b><i>Step 2</i></b></h4>

<p id="cn-m18-317">On the <b>Warning: Potential Security Risk Ahead, </b>click <b>Advanced</b>.</p>

<p id="cn-m18-318"></p><figure><img class="cn-img" id="cn-image-m18-c-27" src="IdentifyingDifferentApplicationExploits_files/image-m18-c-27.jpg" alt="Figure 4.2 Screenshot of PLABKALI"><figcaption>Figure 4.2 Screenshot of PLABKALI: Displaying opening the web site in the Firefox browser and selecting Advanced.</figcaption></figure><p></p>

<h4 id="cn-m18-319"><b><i>Step 3</i></b></h4>

<p id="cn-m18-320">Click <b>Accept the Risk and Continue</b>.</p>

<p id="cn-m18-321"></p><figure><img class="cn-img" id="cn-image-m18-c-28" src="IdentifyingDifferentApplicationExploits_files/image-m18-c-28.jpg" alt="Figure 4.3 Screenshot of PLABKALI"><figcaption>Figure 4.3 Screenshot of PLABKALI: Displaying opening the web site in the Firefox browser.</figcaption></figure><p></p>

<h4 id="cn-m18-322"><b><i>Step 4 </i></b></h4>

<p id="cn-m18-323">Click <b>Sign in </b>on the web page.</p>

<p id="cn-m18-324"></p><figure><img class="cn-img" id="cn-image-m18-c-29" src="IdentifyingDifferentApplicationExploits_files/image-m18-c-29.jpg" alt="Figure 4.4 Screenshot of PLABKALI"><figcaption>Figure 4.4 Screenshot of PLABKALI: Displaying logging into the web page.</figcaption></figure><p></p>

<h4 id="cn-m18-325"><b><i>Step 5</i></b></h4>

<p id="cn-m18-326">Enter the following credentials:</p>

<p id="cn-m18-327"><b>Username: </b></p>

<pre id="cn-m18-328"><code>admin

</code></pre>

<p id="cn-m18-329"><b>Password:</b></p>

<span class="cn-password">admin</span>

<p id="cn-m18-331">Click <b>Login</b>.</p>

<p id="cn-m18-334"></p><figure><img class="cn-img" id="cn-image-m18-c-30" src="IdentifyingDifferentApplicationExploits_files/image-m18-c-30.jpg" alt="Figure 4.5 Screenshot of PLABKALI"><figcaption>Figure 4.5 Screenshot of PLABKALI: Displaying the vulnerable application authentication using the default credentials to log in.</figcaption></figure><p></p>

<h4 id="cn-m18-335"><b><i>Step 6 </i></b></h4>

<p id="cn-m18-336">Click on the Feedback link next to the search bar.</p>

<p id="cn-m18-337"></p><figure><img class="cn-img" id="cn-image-m18-c-31" src="IdentifyingDifferentApplicationExploits_files/image-m18-c-31.jpg" alt="Figure 4.6 Screenshot of PLABKALI"><figcaption>Figure 4.6 Screenshot of PLABKALI: Displaying the Admin user home page and selecting the feedback link.</figcaption></figure><p></p>

<h4 id="cn-m18-338"><b><i>Step 7  </i></b></h4>

<p id="cn-m18-339">Complete the form with the following information:</p>

<p id="cn-m18-340"><b>Your Name:</b></p>

<pre id="cn-m18-341"><code>Admin User

</code></pre>

<p id="cn-m18-342"><b>Your Email Address: </b></p>

<pre id="cn-m18-343"><code>test@test.com

</code></pre>

<p id="cn-m18-344"><b> Subject: </b></p>

<pre id="cn-m18-345"><code>Test

</code></pre>

<p id="cn-m18-346"><b>Question/Comment: </b></p>

<pre id="cn-m18-347"><code>aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa

</code></pre>

<span class="cn-quote" id="cn-m18-348"><b><i>Note: </i></b><i>In the </i><b><i>Question/Comment field</i></b><i>, supply a large volume of random data.</i></span>

<p id="cn-m18-349">Click <b>Submit</b>.</p>

<p id="cn-m18-350"></p><figure><img class="cn-img" id="cn-image-m18-c-32" src="IdentifyingDifferentApplicationExploits_files/image-m18-c-32.jpg" alt="Figure 4.7 Screenshot of PLABKALI"><figcaption>Figure
 4.7 Screenshot of PLABKALI: Displaying completing the web form 
attempting to conduct a buffer overflow attack on a vulnerable web site.</figcaption></figure><p></p>

<h4 id="cn-m18-351"><b><i>Step 8</i></b></h4>

<p id="cn-m18-352">The application does not perform a length check and so is vulnerable to overflow attacks.</p>

<p id="cn-m18-353"></p><figure><img class="cn-img" id="cn-image-m18-c-33" src="IdentifyingDifferentApplicationExploits_files/image-m18-c-33.jpg" alt="Figure 4.8 Screenshot of PLABKALI"><figcaption>Figure
 4.8 Screenshot of PLABKALI: Displaying the Thank you page after 
submitting the feedback with a large volume of data, indicating that the
 web page is vulnerable to a buffer overflow attack.</figcaption></figure><p></p>

<span class="atom-code hidden">80e3ace3-3818-477e-9d50-9fdfea66eb75</span>

<h4 id="cn-m18-356"><b><i>Step 9</i></b></h4>

<p id="cn-m18-357">Close the <b>Firefox </b>web browser.</p>

<p id="cn-m18-358"></p><figure><img class="cn-img" id="cn-image-m18-c-34" src="IdentifyingDifferentApplicationExploits_files/image-m18-c-34.jpg" alt="Figure 4.9 Screenshot of PLABKALI"><figcaption>Figure 4.9 Screenshot of PLABKALI: Displaying closing the Firefox web browser.</figcaption></figure><p></p>

<span class="cn-alert" id="cn-m18-359">Leave all devices in their current state and proceed to the next exercise.</span>
< <a href="https://github.com/SeanOhAileasa" id="TraversalandPathManipulation">Home</a> | <a href="https://github.com/SeanOhAileasa/syp-practice-labs/blob/main/README.md">README</a> > 
<h2>CompTIA Security+ Practice Labs</h2>
<div class="print-exercise-break"></div><h2 class="exercise-title" id="cn-m18-362"><b>Exercise 5 - Directory Traversal and Path Manipulation</b></h2>

<p id="cn-m18-363">Directory traversal vulnerability allows an attacker 
to traverse the webserver directory and access files that are otherwise 
not allowed access. Directory traversal is also called path traversal. A
 directory listing loophole lists all the files and sub-directories used
 in the web application. A path manipulation vulnerability allows the 
upload of malicious files into the application. Directory traversal 
vulnerabilities at the minimum, help identify the root directory of the 
application. This helps to advance other exploits. A file inclusion 
vulnerability allows you to upload files of your choice into the 
application directory. Path traversal is also called a “dot dot slash” 
attack.</p>

<p id="cn-m18-364">In this exercise, you will exploit directory listing vulnerabilities.</p>

<h2 class="cn-learningobjectives"><b>Learning Outcomes</b></h2>

<p id="cn-m18-366">After completing this exercise, you should be able to:</p>

<ul id="cn-m18-367">

<li id="cn-m18-367">Exploit Directory Listing Vulnerability</li>

</ul>

<h2 class="cn-devices"><b>Your Devices</b></h2>

<p id="cn-m18-369">You will be using the following device in this exercise. Please power this on now.</p>

<ul id="cn-m18-370">

<li id="cn-m18-370"><b>PLABKALI </b>- Kali 2019.4 (Stand-alone device)</li>

</ul>

<p id="cn-m18-371"><img class="cn-img" id="cn-image-m18-c-35" src="IdentifyingDifferentApplicationExploits_files/image-m18-c-35.jpg" alt="Practice Labs screenshot."></p>

<h3 id="cn-m18-372"><b>Task 1 - Exploit Directory Listing Vulnerability</b></h3>

<p id="cn-m18-373">A directory listing allows you to see pages or links within an application that you are not authorized to access.</p>

<p id="cn-m18-374">In this task, you will learn to exploit directory listings by searching the application URLs.</p>

<h4 id="cn-m18-375"><b><i>Step 1 </i></b></h4>

<p id="cn-m18-376">Connect to <b>PLABKALI</b>.</p>

<p id="cn-m18-377">Click the <b>Kali Dragon icon </b>and select <b>Web Browser</b></p>

<p id="cn-m18-378"></p><figure><img class="cn-img" id="cn-image-m18-c-36" src="IdentifyingDifferentApplicationExploits_files/image-m18-c-36.jpg" alt="Figure 5.1 Screenshot of PLABKALI"><figcaption>Figure 5.1 Screenshot of PLABKALI: Displaying opening the Firefox Web Browser.</figcaption></figure><p></p>

<h4 id="cn-m18-379"><b><i>Step 2</i></b></h4>

<p id="cn-m18-380">In the <b>Firefox </b>web browser, browse to the following web page:</p>

<pre id="cn-m18-381"><code>http://testphp.vulnweb.com/

</code></pre>

<p id="cn-m18-383"></p><figure><img class="cn-img" id="cn-image-m18-c-37" src="IdentifyingDifferentApplicationExploits_files/image-m18-c-37.jpg" alt="Figure 5.2 Screenshot of PLABKALI"><figcaption>Figure 5.2 Screenshot of PLABKALI: Displaying a Vulnerable web application website.</figcaption></figure><p></p>

<h4 id="cn-m18-384"><b><i>Step 3 </i></b></h4>

<p id="cn-m18-385">In the <b>Firefox  </b>web browser, open a new tab and browse to the following url:</p>

<pre id="cn-m18-386"><code>http://testphp.vulnweb.com/showimage.php?file=./pictures/7.jpg

</code></pre>

<p id="cn-m18-388"></p><figure><img class="cn-img" id="cn-image-m18-c-38" src="IdentifyingDifferentApplicationExploits_files/image-m18-c-38.jpg" alt="Figure 5.3 Screenshot of PLABKALI"><figcaption>Figure 5.3 Screenshot of PLABKALI: Displaying opening the URL in a new tab in the Firefox browser.</figcaption></figure><p></p>

<span class="cn-quote" id="cn-m18-389"><b><i>Note: </i></b><i>Since the web application is vulnerable to directory traversal, the </i><b><i>./ </i></b><i>combination allows you to pull files from the application directory.</i></span>

<h4 id="cn-m18-390"><b><i>Step 4 </i></b></h4>

<p id="cn-m18-391">In the Firefox browser, open another tab and navigate to:</p>

<pre id="cn-m18-392"><code>http://testphp.vulnweb.com/CVS/

</code></pre>

<p id="cn-m18-393">Here you can see the directory listed.</p>

<p id="cn-m18-394"></p><figure><img class="cn-img" id="cn-image-m18-c-39" src="IdentifyingDifferentApplicationExploits_files/image-m18-c-39.jpg" alt="Figure 5.4 Screenshot of PLABKALI"><figcaption>Figure 5.4 Screenshot of PLABKALI: Displaying opening the URL in a new tab in the Firefox browser .</figcaption></figure><p></p>

<span class="atom-code hidden">80e3ace3-3818-477e-9d50-9fdfea66eb75</span>

<p id="cn-m18-397">Close the <b>Firefox </b>browser.</p>

<span class="cn-alert" id="cn-m18-398">Leave all devices in their current state and proceed to the next exercise.</span>
< <a href="https://github.com/SeanOhAileasa" id="PrivilegeEscalation">Home</a> | <a href="https://github.com/SeanOhAileasa/syp-practice-labs/blob/main/README.md">README</a> > 
<h2>CompTIA Security+ Practice Labs</h2>
<div class="print-exercise-break"></div><h2 class="exercise-title" id="cn-m18-402"><b>Exercise 6 - Privilege Escalation</b></h2>

<p id="cn-m18-403">Privilege escalation allows a normal user access they
 would not otherwise have access to. There are two types of privilege 
escalation - horizontal and vertical. Horizontal privilege escalation 
allows unauthorized access to system resources or application files of 
another user at the same level or role within an organization.</p>

<p id="cn-m18-404">In this exercise, you will learn to perform vertical privilege escalation.</p>

<h2 class="cn-learningobjectives"><b>Learning Outcomes</b></h2>

<p id="cn-m18-406">After completing this exercise, you should be able to:</p>

<ul id="cn-m18-407">

<li id="cn-m18-407">Perform Vertical Privilege Escalation</li>

</ul>

<h2 class="cn-devices"><b>Your Devices</b></h2>

<p id="cn-m18-409">You will be using the following device in this exercise. Please power this on now.</p>

<ul id="cn-m18-410">

<li id="cn-m18-410"><b>PLABKALI </b>- Kali 2019.4 (Stand-alone device)</li>

</ul>

<p id="cn-m18-411"><img class="cn-img" id="cn-image-m18-c-40" src="IdentifyingDifferentApplicationExploits_files/image-m18-c-40.jpg" alt="Practice Labs screenshot."></p>

<h3 id="cn-m18-412"><b>Task 1 - Perform Vertical Privilege Escalation</b></h3>

<h4 id="cn-m18-413"><b><i>Step 1 </i></b></h4>

<p id="cn-m18-414">Connect to <b>PLABKALI</b>.</p>

<p id="cn-m18-415">Launch the <b>Firefox </b>browser as shown in the previous exercises and navigate to:</p>

<pre id="cn-m18-416"><code> http://testphp.vulnweb.com/

</code></pre>

<p id="cn-m18-417"></p><figure><img class="cn-img" id="cn-image-m18-c-41" src="IdentifyingDifferentApplicationExploits_files/image-m18-c-41.jpg" alt="Figure 6.1 Screenshot of PLABKALI"><figcaption>Figure 6.1 Screenshot of PLABKALI: Displaying the vulnerable web application in the Firefox web browser.</figcaption></figure><p></p>

<h4 id="cn-m18-418"><b><i>Step 2 </i></b></h4>

<p id="cn-m18-419">Without authenticating, try accessing the following URL:</p>

<pre id="cn-m18-420"><code>http://testphp.vulnweb.com/admin/

</code></pre>

<p id="cn-m18-421"></p><figure><img class="cn-img" id="cn-image-m18-c-42" src="IdentifyingDifferentApplicationExploits_files/image-m18-c-42.jpg" alt="Figure 6"><figcaption>Figure 6:2 Screenshot of PLABKALI: Displaying the vulnerable web application listing the directory contents.</figcaption></figure><p></p>

<span class="atom-code hidden">80e3ace3-3818-477e-9d50-9fdfea66eb75</span>

<span class="cn-quote" id="cn-m18-424"><b><i>Note: </i></b><i>Since the application is vulnerable, it displays the admin folder.</i></span>

<span class="cn-alert" id="cn-m18-425">Leave all devices in their current state and proceed to the next exercise.</span>
< <a href="https://github.com/SeanOhAileasa" id="DriverManipulationandReplayAttacks">Home</a> | <a href="https://github.com/SeanOhAileasa/syp-practice-labs/blob/main/README.md">README</a> > 
<h2>CompTIA Security+ Practice Labs</h2>
<div class="print-exercise-break"></div><h2 class="exercise-title" id="cn-m18-427"><b>Exercise 7 - Driver Manipulation and Replay Attacks</b></h2>

<p id="cn-m18-428">Driver manipulation and replay attacks are less 
prevalent in web applications. However, exploitation of these 
vulnerabilities could lead to serious consequences that compromise 
confidentiality, integrity and availability.</p>

<p id="cn-m18-429">In this exercise, you will learn about driver manipulation and replay attacks.</p>

<h2 class="cn-learningobjectives"><b>Learning Outcomes</b></h2>

<p id="cn-m18-431">After completing this exercise, you should have further knowledge of:</p>

<ul id="cn-m18-432">

<li id="cn-m18-432">Device Manipulation and Replay Attacks</li>

</ul>

<h2 class="cn-devices"><b>Your Devices </b></h2>

<p id="cn-m18-434">This exercise contains supporting materials for Security+.</p>

<p id="cn-m18-435"><img class="cn-img" id="cn-image-m18-c-43" src="IdentifyingDifferentApplicationExploits_files/image-m18-c-43.jpg" alt="Practice Labs screenshot."></p>

<h3 id="cn-m18-436"><b>Device Manipulation and Replay Attacks</b></h3>

<p id="cn-m18-437">Device drivers are the primary way for operating 
systems to communicate with the hardware devices. Attackers can 
manipulate the device drivers and compromise security on the system. One
 way to do this is to run malicious code. This is also called a shimming
 attack. Attackers can also alter API call parameters.</p>

<p id="cn-m18-438">Repeating data to perform malicious actions is referred to as a replay attack.</p>

<p id="cn-m18-439">Session hijacking is a form of replay attack. 
Generating a new session without invalidating the existing one allows an
 attacker to steal session information and authenticate to the 
application without valid credentials.</p>

<p id="cn-m18-440">In a Session replay attack, a malicious user gets 
hold of a valid session ID of an authorized user and reuses it to 
impersonate the authorized user to perform malicious activities. Users 
can become victims of this attack when session IDs do not have an 
expiration time or the session data is stored in unencrypted plain-text 
form. Web applications that allow reusing session IDs or session 
credentials for authorization are vulnerable to replay attacks.</p>

<span class="atom-code hidden">7429868b-128c-4069-95a9-7246a6a9e5a3</span>
< <a href="https://github.com/SeanOhAileasa" id="PasstheHashAPIAttacksRequestForgeriesPointerDereferenceandSSLStripping">Home</a> | <a href="https://github.com/SeanOhAileasa/syp-practice-labs/blob/main/README.md">README</a> > 
<h2>CompTIA Security+ Practice Labs</h2>
<div class="print-exercise-break"></div><h2 class="exercise-title" id="cn-m18-443"><b>Exercise 8 - Pass the Hash, API Attacks, Request Forgeries, Pointer Dereference and SSL Stripping</b></h2>

<p id="cn-m18-444">Request forgeries are a sub-type of replay attacks. 
Other attacks like pass the hash, SSL stripping and pointer dereference 
expose sensitive information leading to unauthorized access and 
disclosure.</p>

<p id="cn-m18-445">In this exercise, you will perform a cross site 
request forgery. You will also learn about API Attacks, Pointer 
Dereference, Pass the Hash and SSL Stripping.</p>

<h2 class="cn-learningobjectives"><b>Learning Outcomes</b></h2>

<p id="cn-m18-447">After completing this exercise, you should be able to:</p>

<ul id="cn-m18-448">

<li id="cn-m18-448">Perform Cross Site Request Forgery</li>

</ul>

<p id="cn-m18-449">After completing this exercise, you should have further knowledge of:</p>

<ul id="cn-m18-450">

<li id="cn-m18-450">API Attacks, Pointer Dereference, Pass the Hash and SSL Stripping</li>

</ul>

<h2 class="cn-devices"><b>Your Devices </b></h2>

<p id="cn-m18-452">You will be using the following device in this exercise. Please power this on now.</p>

<ul id="cn-m18-453">

<li id="cn-m18-453"><b>PLABKALI </b>- Kali 2019.4 (Stand-alone device)</li>

</ul>

<p id="cn-m18-454"><img class="cn-img" id="cn-image-m18-c-44" src="IdentifyingDifferentApplicationExploits_files/image-m18-c-44.jpg" alt="Practice Labs screenshot."></p>

<h3 id="cn-m18-455"><b>API Attacks, Pointer Dereference, Pass the Hash and SSL Stripping</b></h3>

<p id="cn-m18-456">There are several types of API attacks used by 
attackers. The most common one is login attacks. Application programming
 interfaces have an authentication process similar to web applications. A
 secure API call could reject invalid login attempts but in reality, 
most APIs are vulnerable to credential surfing attacks resulting in 
successful login without valid credentials. APIs are also vulnerable to 
Denial of Service attacks that result in resource exhaustion or a 
complete take over of the system.</p>

<p id="cn-m18-457">Implementing secure authentication and authorization 
mechanisms to ensure only valid users can access APIs is a must for API 
security. API keys used for authentication should have a similar level 
of protection as usernames and passwords.</p>

<p id="cn-m18-458">SSL Stripping (Secure Socket Layer Stripping) is also
 called an SSL downgrade attack that allows attackers to bypass security
 mechanisms enforced through encryption via SSL certificates.</p>

<p id="cn-m18-459">A pointer, object or a null dereference is where the 
application dereferences a pointer that is expected to be a valid 
address but instead is equal to NULL. Failure to perform a NULL check 
could result in error conditions or exceptions thrown by the 
application, resulting in sensitive information exposure when exposed to
 attackers. The attacker could craft further attacks with the 
information obtained.</p>

<p id="cn-m18-460">A pass the hash attack allows an attacker to resend a
 hashed password value that is captured via a man in the middle attack 
for authenticating into a system. This attack does not require the 
attacker to decrypt the password to plain text.</p>

<h3 id="cn-m18-461"><b>Task 1 - Perform Cross Site Request Forgery</b></h3>

<p id="cn-m18-462">Cross Site Request Forgery is a form of replay attack
 which allows attackers to perform malicious activities on behalf of the
 victim.</p>

<p id="cn-m18-463">A simple way to identify if the application has a 
prevention mechanism for Cross Site Request Forgery is to verify if it 
has a hidden CSRF token in its forms. This can be verified by looking at
 the source of the application.</p>

<p id="cn-m18-464">In this task, you will identify if an application is vulnerable to login Cross Site Request Forgery attacks.</p>

<h4 id="cn-m18-465"><b><i>Step 1 </i></b></h4>

<p id="cn-m18-466">Connect <b>PLABKALI</b>.</p>

<p id="cn-m18-467">Launch the <b>Firefox </b>browser and navigate to:</p>

<pre id="cn-m18-468"><code>http://testphp.vulnweb.com/

</code></pre>

<p id="cn-m18-470"></p><figure><img class="cn-img" id="cn-image-m18-c-45" src="IdentifyingDifferentApplicationExploits_files/image-m18-c-45.jpg" alt="Figure 8.1 Screenshot of PLABKALI"><figcaption>Figure 8.1 Screenshot of PLABKALI: Displaying the Vulnerable web application in the Firefox browser.</figcaption></figure><p></p>

<h4 id="cn-m18-471"><b><i>Step 2 </i></b></h4>

<p id="cn-m18-472">Click on <b>Signup </b>and login to the application using the following credentials:</p>

<p id="cn-m18-473"><b>Username:</b></p>

<pre id="cn-m18-474"><code>test

</code></pre>

<p id="cn-m18-475"><b>Password:</b></p>

<span class="cn-password">test</span>

<p id="cn-m18-477">Click login.</p>

<p id="cn-m18-478"></p><figure><img class="cn-img" id="cn-image-m18-c-46" src="IdentifyingDifferentApplicationExploits_files/image-m18-c-46.jpg" alt="Figure 8.2 Screenshot of PLABKALI"><figcaption>Figure 8.2 Screenshot of PLABKALI: Displaying logging in to the vulnerable web application sign in page.</figcaption></figure><p></p>

<h4 id="cn-m18-479"><b><i>Step 3</i></b></h4>

<p id="cn-m18-480">Right click on the web page and select <b>View Page Source</b>.</p>

<p id="cn-m18-482"></p><figure><img class="cn-img" id="cn-image-m18-c-47" src="IdentifyingDifferentApplicationExploits_files/image-m18-c-47.jpg" alt="Figure 8.3 Screenshot of PLABKALI"><figcaption>Figure
 8.3 Screenshot of PLABKALI: Displaying the user information page and 
right-clicking on the page to view its web page information.</figcaption></figure><p></p>

<h4 id="cn-m18-483"><b><i>Step 4</i></b></h4>

<p id="cn-m18-484">Search through the source code to look for the hidden input field with CSRF tokens.</p>

<p id="cn-m18-485"></p><figure><img class="cn-img" id="cn-image-m18-c-48" src="IdentifyingDifferentApplicationExploits_files/image-m18-c-48.jpg" alt="Figure 8.4 Screenshot of PLABKALI"><figcaption>Figure 8.4 Screenshot of PLABKALI: Displaying the html source code of the vulnerable web application.</figcaption></figure><p></p>

<span class="cn-quote" id="cn-m18-486"><b><i>Note: </i></b><i>Reviewing 
the source code no anti-CSRF tokens are found, indicating that the 
website is vulnerable to a Cross Site Scripting attack.</i></span>

<span class="atom-code hidden">80e3ace3-3818-477e-9d50-9fdfea66eb75</span>

<span class="atom-code hidden">d31298f5-3011-4089-bf06-fbf08c44a7f9</span>

<span class="cn-alert" id="cn-m18-492">Keep all devices that you have powered on in their current state and proceed to the review section.</span>

<div class="print-exercise-break"></div><h2 class="exercise-title" id="cn-m18-494"><b>Review</b></h2>

<p id="cn-m18-495">Well done, you have completed the <b>Identifying Different Application Exploits </b>Practice Lab.</p>

<span class="atom-code hidden">c6e74811-6d1f-4779-94c2-34fcca239022</span>

<span class="atom-code hidden">5a5b1f43-8d77-4a58-9f37-669a5f5a1f24</span>

<span class="atom-code hidden">2cb9d01c-50df-415e-857b-fb96392e9fb9</span>

<span class="atom-code hidden">83c2f087-d172-4eae-a500-7bdeea0e7051</span>

<span class="atom-code hidden">b8e85f31-28f2-4ae5-a5dc-ad44795c5360</span>

<span class="atom-code hidden">ef3bf41e-7ebd-4a9b-a1af-157f84d79049</span>

<span class="atom-code hidden">4a051d07-1e06-4047-92e5-f5ac0feaf005</span>

<span class="atom-code hidden">cec4238b-45cd-4d2f-92e5-63d02c891441</span>

<span class="atom-code hidden">aaaaaaaa-1111-1111-1111-193f35a24fe3</span>

<h2 class="cn-summary"><b>Summary</b></h2>

<p id="cn-m18-508">You completed the following exercises:</p>

<ul id="cn-m18-509">

<li id="cn-m18-509">Exercise 1 - Cross Site Scripting</li>

<li id="cn-m18-510">Exercise 2 - SQL Injection</li>

<li id="cn-m18-511">Exercise 3 - Information Leakage and Improper Error Handling</li>

<li id="cn-m18-512">Exercise 4 - Race Conditions, Memory Leak, Resource Exhaustion and Overflow Attacks</li>

<li id="cn-m18-513">Exercise 5 - Directory Traversal and Path Manipulation</li>

<li id="cn-m18-514">Exercise 6 - Privilege Escalation</li>

<li id="cn-m18-515">Exercise 7 - Driver Manipulation and Replay Attacks</li>

<li id="cn-m18-516">Exercise 8 - Pass the Hash, API Attacks, Request Forgeries, Pointer Dereference and SSL Stripping</li>

</ul>

<p id="cn-m18-517">You should now be able to:</p>

<ul id="cn-m18-518">

<li id="cn-m18-518">Exploit Reflected XSS Attacks</li>

<li id="cn-m18-519">Error-Based SQL Injection</li>

<li id="cn-m18-520">Gather Information from Exception Messages</li>

<li id="cn-m18-521">Identify Buffer Overflow</li>

<li id="cn-m18-522">Exploit Directory Listing Vulnerability</li>

<li id="cn-m18-523">Perform Vertical Privilege Escalation</li>

<li id="cn-m18-524">Perform Cross Site Request Forgery</li>

</ul>

<p id="cn-m18-525">You should now have further knowledge of:&nbsp;</p>

<ul id="cn-m18-526">

<li id="cn-m18-526">Types of XSS Attacks</li>

<li id="cn-m18-527">Error Based SQL Injection</li>

<li id="cn-m18-528">Device Manipulation and Replay Attacks</li>

<li id="cn-m18-529">API Attacks, Pointer Dereference, Pass the Hash and SSL Stripping</li>

</ul>

<h2 class="cn-feedback"><b>Feedback</b></h2>

<span class="atom-code hidden">067744a4-4299-4662-b5be-04dbb636a007</span>

<span class="cn-alert" id="cn-m18-533">Shutdown all virtual machines used in this lab. Alternatively, you can log out of the lab platform.</span>


                </div>
            </div>
        
</div>
    </div>
    </form>


</body></html>